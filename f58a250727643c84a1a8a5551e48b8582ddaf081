{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "a9959df1_537800c5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2023-06-05T21:30:47Z",
      "side": 1,
      "message": "I\u0027m ready to start submitting this. Does the mallopt name seem reasonable? I always have the worst issues with names.",
      "revId": "f58a250727643c84a1a8a5551e48b8582ddaf081",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "13fd2059_1361d817",
        "filename": "libc/include/malloc.h",
        "patchSetId": 2
      },
      "lineNbr": 323,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2023-06-05T21:34:33Z",
      "side": 1,
      "message": "explain when you\u0027d want this rather than mallinfo() or malloc_info() instead? (in particular --- why would i use this rather than malloc_info(), which i can send to any FILE*? is that just because there\u0027s no convenient FILE* for \"the log\"?)",
      "revId": "f58a250727643c84a1a8a5551e48b8582ddaf081",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ef188daf_c58aab26",
        "filename": "libc/include/malloc.h",
        "patchSetId": 2
      },
      "lineNbr": 323,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2023-06-05T21:58:13Z",
      "side": 1,
      "message": "This is to dump detailed stats that are not as easily retrieved through mallinfo or malloc_info. Specifically, this is so that we can ask partners who are having problems to get extra information that cannot be gained through those other calls.\n\nAlso, the idea is that you can run:\n\n  dumpsys meminfo --logstats \u003cPID\u003e\n  \nAnd then capture the log for us and we can tell what\u0027s going on in scudo/jemalloc. On jemalloc, it\u0027s not logging very much, more to make sure that if a partner is doing a comparison we can make sure it\u0027s apples to apples. On scudo, it\u0027s logging a ton of information about size classes and other data (including the thread cache information).\n\nThat\u0027s why the name might not be good. Maybe it should be something like M_LOG_INTERNAL_STATS",
      "parentUuid": "13fd2059_1361d817",
      "revId": "f58a250727643c84a1a8a5551e48b8582ddaf081",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e7968bb9_0b6bddf6",
        "filename": "libc/include/malloc.h",
        "patchSetId": 2
      },
      "lineNbr": 323,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2023-06-05T22:04:10Z",
      "side": 1,
      "message": "should they be unified, so this works by calling malloc_info()? although that\u0027s xml, right, whereas this is human-readable? (which is probably another point to call out in the doc comment.)\n\ni\u0027m not sure \"internal\" helps ... all stats are internal bookkeeping info :-)\n\nprobably worth calling out the dumpsys connection in the doc comment (especially because that\u0027s probably how 99% of callers will actually want to use this), but i actually think the vague M_LOG_STATS is fine^Wbetter than trying to be overly specific?\n\nmaybe an explicit note about not relying on the output format; that it varies between allocators and API levels?",
      "parentUuid": "ef188daf_c58aab26",
      "revId": "f58a250727643c84a1a8a5551e48b8582ddaf081",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b8e2c849_91602dcb",
        "filename": "libc/include/malloc.h",
        "patchSetId": 2
      },
      "lineNbr": 323,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2023-06-06T01:41:17Z",
      "side": 1,
      "message": "Since the main reason for this is a way to get scudo data from a running app, it doesn\u0027t make as much sense to add it into the xml call. Right now, these stats are dumped in scudo code, and I don\u0027t think we want to have that code have to return xml formatted data.\n\nI updated the description in the comments, but I didn\u0027t mention the dumpsys command directly. I added that to the description of the check-in comment.",
      "parentUuid": "e7968bb9_0b6bddf6",
      "revId": "f58a250727643c84a1a8a5551e48b8582ddaf081",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}