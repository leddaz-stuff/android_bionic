{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "6e78a434_9749c38c",
        "filename": "libc/malloc_debug/tests/malloc_debug_system_tests.cpp",
        "patchSetId": 2
      },
      "lineNbr": 78,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2021-07-23T15:37:51Z",
      "side": 1,
      "message": "lol at the optimism here that any Android device has ever wrapped pids before it wrapped the entire log buffer!\n\n(i guess you could always configure a 4GiB log buffer and run `while /bin/true ; do /bin/false ; done` on all the other cores :-) )",
      "range": {
        "startLine": 77,
        "startChar": 9,
        "endLine": 78,
        "endChar": 21
      },
      "revId": "029cf33e5c3fb39e2a9aab2eb902e396f8a86835",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f0e7a10a_0e319079",
        "filename": "libc/malloc_debug/tests/malloc_debug_system_tests.cpp",
        "patchSetId": 2
      },
      "lineNbr": 78,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2021-07-23T18:50:43Z",
      "side": 1,
      "message": "Surprisingly, this happened every time I ran a particular scenario on cuttlefish. That\u0027s why I added this code, because it actually happened.\n\nBy running two copies of the malloc debug system tests, while running the liblog unit tests, it happens by about iteration 20 of the unit tests. It appears cuttlefish has a large logcat buffer, and the death tests were creating enough failing messages in the log. I don\u0027t know why the cuttlefish kernel was reusing pids so quickly.",
      "parentUuid": "6e78a434_9749c38c",
      "range": {
        "startLine": 77,
        "startChar": 9,
        "endLine": 78,
        "endChar": 21
      },
      "revId": "029cf33e5c3fb39e2a9aab2eb902e396f8a86835",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "35b96950_d47545e0",
        "filename": "libc/malloc_debug/tests/malloc_debug_system_tests.cpp",
        "patchSetId": 2
      },
      "lineNbr": 78,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2021-07-23T20:57:41Z",
      "side": 1,
      "message": "whose death tests? ours are supposed to have suppressed stacks now...\n\ni thought we set pid_max higher, but i\u0027m seeing 32k on cf and on both phones i have available. (but 4m on my desktop.) i\u0027ve started a thread to see if i\u0027m the only one who thinks we should bump that up.",
      "parentUuid": "f0e7a10a_0e319079",
      "range": {
        "startLine": 77,
        "startChar": 9,
        "endLine": 78,
        "endChar": 21
      },
      "revId": "029cf33e5c3fb39e2a9aab2eb902e396f8a86835",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3b4fe3a8_ac325718",
        "filename": "libc/malloc_debug/tests/malloc_debug_system_tests.cpp",
        "patchSetId": 2
      },
      "lineNbr": 99,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2021-07-23T15:37:51Z",
      "side": 1,
      "message": "you can\u0027t just use an atomic bool? (explain why not in the comment if not?)",
      "revId": "029cf33e5c3fb39e2a9aab2eb902e396f8a86835",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bf5db257_c565af1b",
        "filename": "libc/malloc_debug/tests/malloc_debug_system_tests.cpp",
        "patchSetId": 2
      },
      "lineNbr": 99,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2021-07-23T18:50:43Z",
      "side": 1,
      "message": "I update the comment to explain this. I also added a comment in another location saying why I wasn\u0027t using the non-blocking version of the read call.",
      "parentUuid": "3b4fe3a8_ac325718",
      "revId": "029cf33e5c3fb39e2a9aab2eb902e396f8a86835",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ee67ea22_fdafe135",
        "filename": "libc/malloc_debug/tests/malloc_debug_system_tests.cpp",
        "patchSetId": 2
      },
      "lineNbr": 99,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2021-07-23T20:57:41Z",
      "side": 1,
      "message": "won\u0027t the signal alone cause the read() to fail with EINTR? oh, the read is inside liblog and protected by TEMP_FAILURE_RETRY? yeah, i get it now. (i might add that part to the comment too though.)",
      "parentUuid": "bf5db257_c565af1b",
      "revId": "029cf33e5c3fb39e2a9aab2eb902e396f8a86835",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e5235bb7_eed81caf",
        "filename": "libc/malloc_debug/tests/malloc_debug_system_tests.cpp",
        "patchSetId": 2
      },
      "lineNbr": 99,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2021-07-23T21:53:25Z",
      "side": 1,
      "message": "I do have a follow-on CL coming, so let me see if I can come up with a comment that describes this situation better.",
      "parentUuid": "ee67ea22_fdafe135",
      "revId": "029cf33e5c3fb39e2a9aab2eb902e396f8a86835",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ee4091b2_8f8e9a12",
        "filename": "libc/malloc_debug/tests/malloc_debug_system_tests.cpp",
        "patchSetId": 2
      },
      "lineNbr": 160,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2021-07-23T15:37:51Z",
      "side": 1,
      "message": "this all makes me wish we had the opposite of logwrapper --- something to cause a process\u0027 logging to all go to stdout/stderr/file, since those are far less painful to deal with. given how few tests seem to be looking for stuff in logs, though, i guess we wouldn\u0027t have enough users to motivate it even if we did have someone working on logging right now...",
      "revId": "029cf33e5c3fb39e2a9aab2eb902e396f8a86835",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "557cabe8_1b835470",
        "filename": "libc/malloc_debug/tests/malloc_debug_system_tests.cpp",
        "patchSetId": 2
      },
      "lineNbr": 160,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2021-07-23T18:50:43Z",
      "side": 1,
      "message": "Yes, I would love that kind of option. The log interface is not the greatest, but it seems like mostly tests are trying to read log messages. So having an intricate log interface doesn\u0027t seem like a good use of time.",
      "parentUuid": "ee4091b2_8f8e9a12",
      "revId": "029cf33e5c3fb39e2a9aab2eb902e396f8a86835",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}