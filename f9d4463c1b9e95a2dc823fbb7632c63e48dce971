{
  "comments": [
    {
      "key": {
        "uuid": "f32e88e3_994e7d48",
        "filename": "libc/private/bionic_fortify.h",
        "patchSetId": 2
      },
      "lineNbr": 49,
      "author": {
        "id": 1079148
      },
      "writtenOn": "2020-06-09T22:23:57Z",
      "side": 1,
      "message": "Should we rewrite this as something that can be inlined instead? Something along the lines of \n\n    template\u003ctypename... Args\u003e\n    static void __fortify_fatal(const char* fmt, Args\u0026\u0026... args) {\n        async_safe_fatal_va_list(\"FORTIFY\", fmt, args...);\n        abort();\n    }",
      "range": {
        "startLine": 38,
        "startChar": 0,
        "endLine": 49,
        "endChar": 0
      },
      "revId": "f9d4463c1b9e95a2dc823fbb7632c63e48dce971",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cd7d1a63_e83877c7",
        "filename": "libc/private/bionic_fortify.h",
        "patchSetId": 2
      },
      "lineNbr": 49,
      "author": {
        "id": 1096946
      },
      "writtenOn": "2020-06-09T22:38:59Z",
      "side": 1,
      "message": "*shrug*\n\nwe get slightly smaller code from keeping this a function than doing something like `#define __fortify_fatal(...) async_safe_fatal(\"FORTIFY: \" __VA_ARGS__)` (which, provided inlining happens, should be equivalent to what you proposed). since this ultimately abort()s, an extra call + a few insns shouldn\u0027t matter, but whatever\u0027s most consistent with existing style is good with me. please lmk what you\u0027d prefer.\n\n(trying to make that `#define` work also caught a format string that\u0027s broken in a semi-pedantic way. if we stick with an actual function here, happy to add `__printflike` if possible)",
      "parentUuid": "f32e88e3_994e7d48",
      "range": {
        "startLine": 38,
        "startChar": 0,
        "endLine": 49,
        "endChar": 0
      },
      "revId": "f9d4463c1b9e95a2dc823fbb7632c63e48dce971",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c111b1f6_72007800",
        "filename": "libc/private/bionic_fortify.h",
        "patchSetId": 2
      },
      "lineNbr": 49,
      "author": {
        "id": 1079148
      },
      "writtenOn": "2020-06-09T22:48:12Z",
      "side": 1,
      "message": "I figured that\u0027d lead to smaller code because you need to set up the call stack identically, but I guess the fact that async_safe_fatal_va_list isn\u0027t noreturn (should it be? +cferris) means that you get extra code generated to call abort.\n\nI don\u0027t have a strong preference here.",
      "parentUuid": "cd7d1a63_e83877c7",
      "range": {
        "startLine": 38,
        "startChar": 0,
        "endLine": 49,
        "endChar": 0
      },
      "revId": "f9d4463c1b9e95a2dc823fbb7632c63e48dce971",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}